<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Matching System</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1>Product Matching System</h1>
            <p>Compare new products against historical catalog</p>
        </header>

        <main class="main-content">
            <!-- Step 1: Upload Historical Catalog -->
            <section class="upload-section" id="historicalSection">
                <div class="section-header">
                    <span class="step-number">1</span>
                    <h2>Upload Historical Catalog (Old Products)</h2>
                </div>
                
                <div class="upload-area">
                    <div class="drop-zone" id="historicalDropZone">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
                        </svg>
                        <p>Drop folder with historical product images here</p>
                        <button class="btn btn-secondary" id="historicalBrowseBtn">Browse Folder</button>
                        <input type="file" id="historicalInput" webkitdirectory directory multiple hidden>
                    </div>
                    
                    <div class="file-info" id="historicalInfo"></div>
                    
                    <div class="csv-upload">
                        <label>
                            Optional: Upload CSV with metadata
                            <span class="info-icon" title="CSV Format:&#10;&#10;First line (optional header):&#10;filename,category,sku,name&#10;&#10;Data rows:&#10;product1.jpg,placemats,SKU-001,Blue Placemat&#10;product2.jpg,dinnerware,SKU-002,White Plate&#10;&#10;• First column must be the image filename&#10;• Other columns are optional&#10;• Use commas to separate values&#10;• Wrap values with commas in quotes">ⓘ</span>
                        </label>
                        <input type="file" id="historicalCsvInput" accept=".csv">
                        <small>Format: filename,category,sku,name,...</small>
                    </div>
                    
                    <button class="btn btn-primary" id="processHistoricalBtn" disabled>Process Historical Catalog</button>
                </div>
                
                <div class="processing-status" id="historicalStatus"></div>
            </section>

            <!-- Step 2: Upload New Products -->
            <section class="upload-section" id="newSection" style="display: none;">
                <div class="section-header">
                    <span class="step-number">2</span>
                    <h2>Upload New Products to Match</h2>
                </div>
                
                <div class="upload-area">
                    <div class="drop-zone" id="newDropZone">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
                        </svg>
                        <p>Drop folder with new product images here</p>
                        <button class="btn btn-secondary" id="newBrowseBtn">Browse Folder</button>
                        <input type="file" id="newInput" webkitdirectory directory multiple hidden>
                    </div>
                    
                    <div class="file-info" id="newInfo"></div>
                    
                    <div class="csv-upload">
                        <label>
                            Optional: Upload CSV with metadata
                            <span class="info-icon" title="CSV Format:&#10;&#10;First line (optional header):&#10;filename,category,sku,name&#10;&#10;Data rows:&#10;product1.jpg,placemats,SKU-001,Blue Placemat&#10;product2.jpg,dinnerware,SKU-002,White Plate&#10;&#10;• First column must be the image filename&#10;• Other columns are optional&#10;• Use commas to separate values&#10;• Wrap values with commas in quotes">ⓘ</span>
                        </label>
                        <input type="file" id="newCsvInput" accept=".csv">
                        <small>Format: filename,category,sku,name,...</small>
                    </div>
                    
                    <button class="btn btn-primary" id="processNewBtn" disabled>Process New Products</button>
                </div>
                
                <div class="processing-status" id="newStatus"></div>
            </section>

            <!-- Step 3: Match Products -->
            <section class="match-section" id="matchSection" style="display: none;">
                <div class="section-header">
                    <span class="step-number">3</span>
                    <h2>Find Matches</h2>
                </div>
                
                <div class="match-controls">
                    <div class="control-group">
                        <label>Similarity Threshold: <span id="thresholdValue">50</span>%</label>
                        <input type="range" id="thresholdSlider" min="0" max="100" value="50">
                    </div>
                    
                    <div class="control-group">
                        <label>Max Matches per Product:</label>
                        <select id="limitSelect">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary btn-large" id="matchBtn">Start Matching</button>
                </div>
                
                <div class="match-progress" id="matchProgress"></div>
            </section>

            <!-- Step 4: Results -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <div class="section-header">
                    <h2>Match Results</h2>
                    <button class="btn btn-secondary" id="exportBtn">Export to CSV</button>
                    <button class="btn btn-secondary" id="resetBtn">Start Over</button>
                </div>
                
                <div class="results-summary" id="resultsSummary"></div>
                
                <div class="results-list" id="resultsList"></div>
            </section>
        </main>
    </div>

    <div id="toast" class="toast"></div>
    
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="modalClose">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
